# yaml-language-server: $schema=https://moonrepo.dev/schemas/project.json

tasks:
  build:
    command:
      - vite
      - build
    inputs: 
      - '@globs(sources)'
      - package.json
      - yarn.lock
    outputs:
      - dist
    deps:
      - ~:typecheck
    platform: node
  lib:
    command:
      - vite
      - build
    inputs: 
      - '@globs(sources)'
      - package.json
      - yarn.lock
    outputs:
      - lib
    args:
      - --mode=lib
    deps:
      - ~:typecheck
    platform: node
  minify:
    command:
      - node
      - esbuild.config.js
    inputs: 
      - lib/leaky-paywall.js
    outputs:
      - lib/leaky-paywall.min.js
    deps:
      - ~:lib
  size:
    command:
      - size-limit
    deps:
      - ~:minify
  typecheck:
    command: vue-tsc
    platform: node
    inputs: 
      - '@globs(sources)'
      - tsconfig.json
      - package.json
      - yarn.lock
  dev:
    command: vite
    local: true
    platform: node
